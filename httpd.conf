ServerRoot "/usr/local/apache2"

Listen 8080
PidFile /dev/shm/httpd.pid

LoadModule mpm_event_module modules/mod_mpm_event.so
LoadModule authn_file_module modules/mod_authn_file.so
LoadModule authn_core_module modules/mod_authn_core.so
LoadModule authz_user_module modules/mod_authz_user.so
LoadModule authz_core_module modules/mod_authz_core.so
LoadModule auth_digest_module modules/mod_auth_digest.so
LoadModule log_config_module modules/mod_log_config.so
LoadModule setenvif_module modules/mod_setenvif.so
LoadModule unixd_module modules/mod_unixd.so
LoadModule headers_module modules/mod_headers.so
LoadModule dav_module modules/mod_dav.so
LoadModule dav_fs_module modules/mod_dav_fs.so
LoadModule alias_module modules/mod_alias.so

LogLevel warn
LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" combined
LogFormat "%h %l %u %t \"%r\" %>s %b" common
CustomLog /proc/self/fd/1 common
ErrorLog /proc/self/fd/2

# Security
User www-data
Group www-data

ServerTokens Prod
ServerSignature Off

<Directory />
	AllowOverride None
	Require all denied
</Directory>

Header always set X-Frame-Options "DENY"
Header always set X-Content-Type-Options "nosniff"
Header always set Referrer-Policy "strict-origin-when-cross-origin"
Header always set X-XSS-Protection "1; mode=block"

# Dav configuration
DavLockDB "/dev/shm/DavLock"
Alias / "/usr/local/apache2/dav/data/"

<Directory "/usr/local/apache2/dav/data">
	Dav On

	AuthType Digest
	AuthName dav
	AuthUserFile "/usr/local/apache2/dav/user.passwd"
	AuthDigestProvider file
	Require valid-user

	Options None
	AllowOverride None
</Directory>
